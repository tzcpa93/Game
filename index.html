<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Expense Report Rampage</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f0f0f0;
    }
    #gameContainer {
      position: relative;
      width: 100%;
      max-width: 600px;
      height: 500px;
      background: #fff;
      overflow: hidden;
      border: 2px solid #333;
      margin: 20px auto;
    }
    .expense {
      position: absolute;
      padding: 10px;
      min-width: 80px;
      text-align: center;
      border: 1px solid #555;
      cursor: pointer;
      border-radius: 4px;
      user-select: none;
    }
    #score, #timer {
      font-size: 24px;
      font-weight: bold;
      margin: 5px;
      display: inline-block;
    }
    #startScreen, #gameOverScreen {
      margin-top: 100px;
    }
    #gameOverScreen {
      display: none;
    }
    button {
      font-size: 16px;
      padding: 10px 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- Opening Screen -->
  <div id="startScreen">
    <h1>Expense Report Rampage</h1>
    <p>Click on fraudulent expenses only! Allowable expenses must be left alone.</p>
    <p>
      <strong>Correct click:</strong> +10 points<br>
      <strong>Wrong click:</strong> -15 points
    </p>
    <p>The game lasts 60 seconds. Watch the score and timer at the top during play.</p>
    <button id="startButton">Start Game</button>
  </div>
  
  <!-- Game Area -->
  <div id="gameContainer" style="display: none;">
    <div id="score">Score: 0</div>
    <div id="timer">Time: 60</div>
  </div>
  
  <!-- Game Over Screen -->
  <div id="gameOverScreen">
    <h1 id="finalMessage"></h1>
    <p>Your final score: <span id="finalScore"></span></p>
    <button id="restartButton">Play Again</button>
  </div>
  
  <script>
    // Game Variables
    let score = 0;
    let timeLeft = 60;
    let gameInterval;
    let expenseInterval;
    let expenseSpeed = 1; // starting vertical speed (pixels per frame)
    const gameContainer = document.getElementById("gameContainer");
    const scoreDisplay = document.getElementById("score");
    const timerDisplay = document.getElementById("timer");
    const startScreen = document.getElementById("startScreen");
    const gameOverScreen = document.getElementById("gameOverScreen");
    const finalMessage = document.getElementById("finalMessage");
    const finalScore = document.getElementById("finalScore");
    const restartButton = document.getElementById("restartButton");
    
    // Expense Categories
    const allowableExpenses = ["Office Supplies", "Client Lunch", "Software Subscription", "Conference Fees"];
    const unallowableExpenses = ["Concert Tickets", "Spa Treatments", "Luxury Watch", "Golf Club Membership"];
    
    // Start Game Function
    function startGame() {
      score = 0;
      timeLeft = 60;
      expenseSpeed = 1;
      scoreDisplay.textContent = "Score: " + score;
      timerDisplay.textContent = "Time: " + timeLeft;
      
      // Clear any existing expenses
      gameContainer.querySelectorAll(".expense").forEach(exp => exp.remove());
      
      startScreen.style.display = "none";
      gameOverScreen.style.display = "none";
      gameContainer.style.display = "block";
      
      // Timer countdown
      gameInterval = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = "Time: " + timeLeft;
        
        // Gradually increase speed every 10 seconds
        if (timeLeft % 10 === 0) {
          expenseSpeed += 0.5;
        }
        
        if (timeLeft <= 0) {
          endGame();
        }
      }, 1000);
      
      // Generate expenses at random intervals (between 1-2 seconds)
      expenseInterval = setInterval(() => {
        generateExpense();
      }, Math.random() * 1000 + 1000);
      
      // Begin animation loop
      requestAnimationFrame(updateExpenses);
    }
    
    // Create and add an expense element
    function generateExpense() {
      const expenseDiv = document.createElement("div");
      expenseDiv.className = "expense";
      
      // Randomly decide if this is unallowable (fraudulent) or allowable
      let isUnallowable = Math.random() < 0.5;
      let label;
      if (isUnallowable) {
        label = unallowableExpenses[Math.floor(Math.random() * unallowableExpenses.length)];
      } else {
        label = allowableExpenses[Math.floor(Math.random() * allowableExpenses.length)];
      }
      expenseDiv.textContent = label;
      expenseDiv.dataset.unallowable = isUnallowable;
      
      // Set random horizontal position
      const containerWidth = gameContainer.offsetWidth;
      const x = Math.random() * (containerWidth - 100);
      expenseDiv.style.left = x + "px";
      
      // Position at the bottom of the container
      expenseDiv.style.top = gameContainer.offsetHeight + "px";
      
      // Random background color for variety
      expenseDiv.style.backgroundColor = getRandomColor();
      
      // Click event for expense elimination
      expenseDiv.addEventListener("click", function() {
        if (this.dataset.unallowable === "true") {
          // Correct click on fraudulent expense
          score += 10;
          this.remove();
        } else {
          // Incorrect click on an allowable expense
          score -= 15;
          flashError();
        }
        scoreDisplay.textContent = "Score: " + score;
      });
      
      gameContainer.appendChild(expenseDiv);
    }
    
    // Update positions of expense elements (simple upward movement)
    function updateExpenses() {
      const expenses = gameContainer.querySelectorAll(".expense");
      expenses.forEach(exp => {
        let currentTop = parseFloat(exp.style.top);
        exp.style.top = (currentTop - expenseSpeed) + "px";
        
        // Remove expense if it moves off the top of the screen
        if (currentTop < -50) {
          exp.remove();
        }
      });
      if (timeLeft > 0) {
        requestAnimationFrame(updateExpenses);
      }
    }
    
    // Brief flash to indicate error on wrong click
    function flashError() {
      const originalColor = document.body.style.backgroundColor;
      document.body.style.backgroundColor = "red";
      setTimeout(() => {
        document.body.style.backgroundColor = originalColor;
      }, 100);
    }
    
    // End game and display results
    function endGame() {
      clearInterval(gameInterval);
      clearInterval(expenseInterval);
      
      // Remove any remaining expenses
      gameContainer.querySelectorAll(".expense").forEach(exp => exp.remove());
      gameContainer.style.display = "none";
      
      finalScore.textContent = score;
      // Display a fun message based on final score
      if (score >= 100) {
        finalMessage.textContent = "Audit Superstar!";
      } else if (score >= 0) {
        finalMessage.textContent = "Balanced Books, But There's Room for Improvement!";
      } else {
        finalMessage.textContent = "Time for a Tax Review!";
      }
      
      gameOverScreen.style.display = "block";
    }
    
    // Helper function to generate a random color
    function getRandomColor() {
      const letters = '89ABCDEF';
      let color = '#';
      for (let i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * letters.length)];
      }
      return color;
    }
    
    // Event Listeners for starting and restarting the game
    document.getElementById("startButton").addEventListener("click", startGame);
    restartButton.addEventListener("click", startGame);
  </script>
</body>
</html>
